import { AuthConfig } from '@auth/core';
import { User } from 'next-auth';

type SessionCallback = NonNullable<AuthConfig['callbacks']>['session'];

export const session: SessionCallback = async function ({ session, token }) {
<% if(provider !== 'none') { %>
  if (token && token.error) {
    return { ...session, user: undefined };
  }
<% } %>
  if (token.user) {
    return {
      ...session,
      user: token.user as User,
    };
  }

  return session;
};
